{% for response in responses %}
<tr class="hover:bg-blue-50 transition-colors group">
  <td class="font-medium px-6 py-4 text-gray-900">
    {{ forloop.counter | add:responses.start_index | add:-1 }}
  </td>
  <td class="px-6 py-4">
    {% if response.respondent %}
    <div class="flex items-center gap-6">
      <div
        class="h-10 w-10 rounded-full bg-white border-2 border-indigo-100 flex items-center justify-center text-indigo-700 font-bold text-base shadow-md"
      >
        {{ response.respondent.username|slice:":1"|upper }}
      </div>
      <span class="font-medium text-gray-700"
        >{{ response.respondent.username }}</span
      >
    </div>
    {% else %}
    <div class="flex items-center gap-3">
      <div
        class="h-9 w-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 ring-1 ring-gray-200 shadow-sm"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            fill-rule="evenodd"
            d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
            clip-rule="evenodd"
          />
        </svg>
      </div>
      <span class="italic text-gray-500">Anonymous</span>
    </div>
    {% endif %}
  </td>
  <td class="px-6 py-4 text-gray-600">
    {{ response.created_at|date:"M d, Y H:i" }}
  </td>
  <td class="px-6 py-4">
    <span
      class="badge {% if response.completed %}badge-success gap-1 text-white{% else %}badge-warning gap-1{% endif %} badge-sm font-medium py-3"
    >
      {% if response.completed %}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-3 w-3"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M5 13l4 4L19 7"
        />
      </svg>
      Completed {% else %}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-3 w-3"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      Incomplete {% endif %}
    </span>
  </td>
  <td class="text-center px-6 py-4">
    <button
      class="btn btn-sm btn-ghost text-primary hover:bg-primary hover:text-white transition-colors"
      onclick="viewResponse{{ response.id }}.showModal()"
    >
      View Details
    </button>

    <!-- Modal for response details -->
    <dialog id="viewResponse{{ response.id }}" class="modal">
      <div class="modal-box max-w-2xl">
        <form method="dialog">
          <button
            class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2"
          >
            âœ•
          </button>
        </form>
        <h3 class="font-bold text-xl mb-6 border-b pb-2 text-gray-800">
          Response Details
        </h3>
        <div class="space-y-4 max-h-[60vh] overflow-y-auto pr-2">
          {% for answer in response.answers.all %}
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-100">
            <p class="font-semibold text-gray-800 mb-2 text-sm">
              <span class="text-primary mr-2">Q{{ forloop.counter }}.</span>{{ answer.question.label }}
            </p>
            <div class="text-gray-600 pl-6 border-l-2 border-primary/20">
              {% if answer.answer_data is not None %} {{ answer.answer_data }}
              {% else %}
              <span class="italic text-gray-400">No answer provided</span>
              {% endif %}
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="modal-action border-t pt-4 mt-6">
          <form method="dialog">
            <button class="btn">Close</button>
          </form>
        </div>
      </div>
      <form method="dialog" class="modal-backdrop">
        <button>close</button>
      </form>
    </dialog>
  </td>
</tr>
{% empty %}
<tr>
  <td colspan="5" class="text-center py-12 text-gray-500 bg-gray-50">
    <div class="flex flex-col items-center justify-center">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-12 w-12 mb-3 text-gray-300"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
        />
      </svg>
      <p class="text-lg font-medium">No responses yet</p>
      <p class="text-sm text-gray-400">Share your survey to get started</p>
    </div>
  </td>
</tr>
{% endfor %}
